(()=>{"use strict";const e=e=>{let t=e,s=!1,o="",r=()=>s;return{setOwner:(e="x||o")=>0==r()&&(((e=!1)=>{s=e})(!0),o=e,!0),getIsOwn:r,getOwner:()=>o,getPos:()=>t,reset:()=>{s=!1,o=""}}};function t(e,t){let s=e,o=function(){let e={A:[],B:[],C:[]};return{getTitles:()=>e,setTitle:(t="")=>{let s=t.split(""),o=s[0].toUpperCase();e[o].push(s[0]+s[1]),e[o].length>1&&((t="")=>{let s=[];s=e[t];let o="";for(let e=0;e<s.length;e++)for(let t=0;t<s.length;t++){let r=e=>s[e].split("")[1];r(e)<r(t)&&(o=s[t],s[t]=s[e],s[e]=o)}})(o)},reset:()=>{Object.keys(e).forEach((t=>{e[t]=[]}))}}}(),r={requestTitle:`request_title_${s}`,reqTitleResponse:`request_title_resp_${s}`,reqTitlesOwned:`submit_titles_owned_${s}`,reset:`reset_${s}`},n=(e={resp:s,pos:n})=>{let s=e.resp,n=e.pos;1==s&&o.setTitle(n),t.publish(r.reqTitlesOwned,o.getTitles())};return t.subscribe(r.reqTitleResponse,n),t.subscribe(r.reset,reset),{setTitel:n,requestTitle:(e="A",o=0)=>{const n={Group:e,Pos:o,Owner:s};t.publish(r.requestTitle,n)},getTitles:o.getTitles}}window.pubSub=(()=>{let e={};return{publish:(t,s)=>{void 0===e[t]?console.log(`PubSub : ${t} does not exist`):e[t].forEach((e=>{e(s)}))},subscribe:(t,s)=>{null==e[t]&&(e[t]=[]),e[t].push(s)},emit:t=>{void 0===e[t]?console.log(`PubSub : ${t} does not exist`):e[t].forEach((e=>{e()}))}}})(),window.board=(t=>{let s={A:[e("a0"),e("a1"),e("a2")],B:[e("b0"),e("b1"),e("b2")],C:[e("c0"),e("c1"),e("c2")]},o=(()=>{let e=1,t={x:0,o:0,draw:0};return{setWinner:(e="draw")=>{t[e]+=1},reset:()=>{e=1,Object.keys(t).forEach((e=>{t[e]=0}))},setRound:()=>{e++},getData:()=>(console.log(`Results : Round#${e}`),console.log(`x : ${t.x} , o : ${t.o} , draws : ${t.draw}`),t)}})(),r=e=>`request_title_${e}`,n=e=>`request_title_resp_${e}`,l=e=>`submit_titles_owned_${e}`,u={check:e=>{if(null!=typeof e)return 1==(e=>{let t=(e,t)=>{let s=[],o=0,r=["a","b","c"].map((e=>e+t)),n=0;return Object.keys(e).forEach((o=>{r[n]==e[o][t]?s.push(!0):s.push(!1),n+=1})),s.forEach((e=>{1==e&&(o+=1)})),3==o};return 1==t(e,0)||1==t(e,1)||1==t(e,2)})(e)||1==(e=>{let t=(e,t)=>{let s=[],o=!1,r=[0,1,2].map((e=>t.toLowerCase()+e)),n=0;return r.forEach((o=>{o==e[t][n]?s.push(!0):s.push(!1),n+=1})),s.forEach((e=>{o=0!=e})),o};return 1==t(e,"A")||1==t(e,"B")||1==t(e,"C")})(e)||1==(e=>{let t=(e,t)=>{let s=0;return Object.keys(e).forEach((o=>{e[o].forEach((e=>{e==t[o]&&(s+=1)}))})),3==s};return 1==t(e,{A:"a0",B:"b1",C:"c2"})||1==t(e,{A:"a2",B:"b1",C:"c0"})})(e);console.log("pattern can't be performed over an undefined object")}},i=(e={Group:"",Pos:0,Owner:""})=>{let o={};o=s[e.Group];let r=o[e.Pos],l=r.setOwner(e.Owner);0==l?(console.log(`${r.getPos()} is owned by ${r.getOwner()}`),t.publish(n(e.Owner),{resp:!1,pos:r.getPos()})):1==l&&(console.log(`${r.getPos()} was take by ${r.getOwner()}`),t.publish(n(e.Owner),{resp:!0,pos:r.getPos()}))},c=()=>{Object.keys(s).forEach((e=>{e.forEach((e=>{e.reset()}))}))};return t.subscribe(r("x"),i),t.subscribe(r("o"),i),t.subscribe(l("x"),(function(e){1==u.check(e)&&(console.log("x won round"),o.setWinner("x"),o.getData(),o.setRound(),c(),t.emit(void 0),t.emit(void 0))})),t.subscribe(l("o"),(function(e){1==u.check(e)&&(console.log("o won round"),o.setWinner("o"),o.getData(),o.setRound(),c(),t.emit(void 0),t.emit(void 0))})),{isWinner:u.check,setTitle:i}})(pubSub),window.playerOne=t("x",pubSub),window.playerTwo=t("o",pubSub)})();